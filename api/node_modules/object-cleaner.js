/**
 * Created by brugnara on 10/06/16,
 * @ daniele@brugnara.me
 */

var debug = require('debug')('url-shrtnr:object-cleaner');

module.exports = function cleaner(object) {

  var keys = Object.keys(object);

  if (!keys.length) {
    return;
  }

  keys.forEach(function(key) {
    var item = object[key];

    debug('cleaning key: %s', key);

    if (Object.prototype.toString.call(item) === '[object Object]') {

      object[key] = cleaner(object[key]);

      // delete empty objects

      if (!Object.keys(object[key]).length) {
        debug('no keys for %s. Cleaning', key);
        delete object[key];
      }

      return;

    }

    if (!item) {
      delete object[key];
    }

  });

  return object;

};